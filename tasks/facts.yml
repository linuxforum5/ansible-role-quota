---
- name: Enable repquota output to be reported in ansible_local facts
  block:

    - name: Packages present
      apt:
        pkg:
          - jq
          - python3-pip
          - python3-setuptools

    - name: Python yq present
      pip:
        name: yq

    - name: Ansible facts.d directory present
      file:
        path: /etc/ansible/facts.d
        state: directory
        mode: 0700
        owner: root
        group: root

    - name: repquota wrapper present
      template:
        src: repquota.fact.j2
        dest: /etc/ansible/facts.d/repquota.fact
        mode: 0700
        owner: root
        group: root

  tags:
    - quota
...
